[
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::new()] [High - Key Reuse] Does Scanner::new verify that the provided key hasn't been used before, or could reusing a key across validator sets cause transaction confusion? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_b6a3216e-24c6-4ee2-819b-380602723f69?mode=deep",
    "timestamp": "2026-02-06 21:27:13.796672",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Infinite Loop DoS] Lines 184-195 have a loop that increments offset until an even point is found - if an attacker provides an offset that leads to a cycle or if the RNG is broken, could this loop forever? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_d4ac7dc5-1c73-4c65-8d91-d1b3d6172d56?mode=deep",
    "timestamp": "2026-02-06 21:27:26.374417",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - Offset Collision] At line 187-189, if a script already exists, None is returned - but what if two legitimate payment channels independently derive the same offset? Are funds lost or is there a recovery mechanism? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_b38bdbf2-6cea-4eb1-932d-4c350182415c?mode=deep",
    "timestamp": "2026-02-06 21:27:39.488225",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Surjective Offset Mapping] The comment at lines 173-175 notes offsets are surjective not bijective - does this mean multiple logical addresses map to the same Bitcoin address, creating a mint/burn accounting vulnerability? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_a8a6280a-955a-4c20-a773-c73a925ea7f4?mode=deep",
    "timestamp": "2026-02-06 21:27:52.599725",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - Arbitrary Script Path] The warning at lines 177-179 about arbitrary offsets introducing script paths is critical - how does the caller ensure offsets are securely generated? What prevents a malicious processor from registering exploitable offsets? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_10d8a5e6-2ec4-4624-90dd-d219e10afd80?mode=deep",
    "timestamp": "2026-02-06 21:28:06.617181",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Medium - Offset Increment] At line 193, offset += Scalar::ONE could overflow if offset is already Scalar::MAX - does this wrap to zero or panic? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_40e659cc-211b-4ece-8b04-cdbe1d45a61d?mode=deep",
    "timestamp": "2026-02-06 21:28:22.047758",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - HashMap Poisoning] If an attacker can register many offsets, can they force the HashMap to reha hash causing DoS, or can they register offsets that collide with future legitimate offsets? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_7134f313-0d8d-4e54-ba98-a6f63f2267d3?mode=deep",
    "timestamp": "2026-02-06 21:28:37.780028",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Registration Order Dependency] The comment at line 174-175 states 'order offsets are registered in may determine validity of future offsets' - could this create a race condition where validators register offsets in different orders and scan different addresses? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_84dad76b-bf49-45c1-a575-6d235f823a01?mode=deep",
    "timestamp": "2026-02-06 21:28:55.515700",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [High - Missing Outputs] At line 203, if vout exceeds 2^32 the scanning stops - could an attacker put a critical payment in output 2^32 + 1 to make it undetectable? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_1df71080-d671-4f50-a9ca-873d18dd4acd?mode=deep",
    "timestamp": "2026-02-06 21:29:14.202796",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Medium - Duplicate Detection] If the same script appears multiple times in tx.output, does scan_transaction return duplicate ReceivedOutputs with the same outpoint but different offsets? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_0873904a-e3e5-4ce1-a8ad-bd3bf44d2313?mode=deep",
    "timestamp": "2026-02-06 21:29:34.058423",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [High - TxID Malleability] Line 209 uses compute_txid() - is this the witness-committed txid (wtxid) or the legacy txid, and could transaction malleability cause the same output to be seen with different outpoints? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_d128e3c1-1e79-4972-92e5-306cc2e722e2?mode=deep",
    "timestamp": "2026-02-06 21:29:54.836502",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Critical - Script Clone] At line 208, output.clone() is called - if the output contains a large witness script, could this be a DoS vector through memory exhaustion? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_590ecac7-bf6e-4827-99ac-84d2c9953965?mode=deep",
    "timestamp": "2026-02-06 21:30:15.514455",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Low - Vec Growth] The result Vec at line 200 has no capacity hint - for a transaction with many matching outputs, could repeated allocations cause performance issues? (Low)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_3fad6401-aefa-418f-97f2-52e7ea93df88?mode=deep",
    "timestamp": "2026-02-06 21:30:37.721804",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Medium - Vout Cast] The try_from at line 203 converts usize to u32 - on 64-bit systems with malicious input, could this silently truncate legitimate vout indices? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_2f58b8f9-0d2b-4df9-84eb-3c64e25079bf?mode=deep",
    "timestamp": "2026-02-06 21:31:00.863106",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [High - Coinbase Maturity] Lines 218-220 mention scanning coinbase transactions bound by maturity - if these immature outputs are used in subsequent transactions before maturity, do they cause consensus failures? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_e079a066-29ed-474c-9807-4c5b6f402e73?mode=deep",
    "timestamp": "2026-02-06 21:31:25.140812",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Medium - Block Scanning Order] At line 223, block.txdata is scanned in order - if a reorg occurs and transactions are reordered, could this cause outputs to be double-counted or missed? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_2732183f-d7b6-41f9-8d6f-c24da302c423?mode=deep",
    "timestamp": "2026-02-06 21:31:48.213373",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Critical - Vec Extend DoS] Line 224 uses extend() without bounds checking - if block contains thousands of matching outputs, could this exhaust memory? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_e29ddaf1-c07e-4068-bdc1-38e98bcef377?mode=deep",
    "timestamp": "2026-02-06 21:32:11.549465",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Low - Unused Result] The result Vec from scan_transaction is immediately extended into res - could there be any race condition or state inconsistency during this operation? (Low)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_8b0251db-91e0-4667-8531-31622f6150ba?mode=deep",
    "timestamp": "2026-02-06 21:32:34.904466",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Insufficient Funds] At lines 215-221, the NotEnoughFunds check compares input_sat < (payment_sat + needed_fee), but does this account for potential integer overflow if payment_sat and needed_fee are near u64::MAX? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_67ba8958-4a30-46a7-a73e-21aeb8811394?mode=deep",
    "timestamp": "2026-02-06 21:32:56.682980",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Fee Underestimation] The fee calculation at line 206 uses vbytes, but lines 225-234 recalculate with change - if the change output causes the transaction to cross a weight boundary, could the fee be underestimated? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_8535b503-780c-4fbd-a98d-e991577ab14f?mode=deep",
    "timestamp": "2026-02-06 21:33:17.517528",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Change Output Theft] At lines 228-234, if input_sat.checked_sub returns None due to underflow, no change output is created and excess funds become fee - could an attacker manipulate inputs to cause this and steal funds via miner fees? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_d8e54ca0-0e01-4250-b7ae-5a9f22e96056?mode=deep",
    "timestamp": "2026-02-06 21:33:39.307996",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - DUST Threshold Bypass] Lines 165-169 check payments against DUST (546 sats), but line 229 checks change against DUST - could an attacker craft inputs that create change just below DUST to burn user funds? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_9083c852-3643-4c15-9a3c-0ca96b2b5fc8?mode=deep",
    "timestamp": "2026-02-06 21:34:01.150518",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Medium - Data Size Limit] Line 171-173 checks data.len() > 80 for OP_RETURN, but does this account for the OP_RETURN opcode bytes themselves, or could a 80-byte payload plus opcode exceed limits? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_62d7e904-a7b6-4dd1-8c71-42eb13ecaf87?mode=deep",
    "timestamp": "2026-02-06 21:34:23.860105",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Empty Outputs] Line 237-239 checks if tx_outs is empty after all operations - could edge cases in change calculation cause all outputs to be removed, passing excess funds to miners? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_9f221df0-9d10-439c-b00a-0a85ec8257c5?mode=deep",
    "timestamp": "2026-02-06 21:34:47.128566",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Transaction Size Overflow] Line 241-243 checks weight against MAX_STANDARD_TX_WEIGHT, but is this checked before or after witnesses are added, and could witness data push it over the limit? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_5937da8a-8993-46ac-88de-204930c8d6c3?mode=deep",
    "timestamp": "2026-02-06 21:35:10.395535",
    "report_generated": false
  }
]