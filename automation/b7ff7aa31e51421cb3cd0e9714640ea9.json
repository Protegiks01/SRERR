[
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignMachine::sign()] [Critical - Share Collection] Lines 377-395 collect shares in a Vec - if shares.push occurs after an early return from ?, could partial shares be created without corresponding signature machines? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ddf29c2d-9d09-45bf-92ab-05dcbb3d748f?mode=deep",
    "timestamp": "2026-02-06 20:41:30.585390",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignMachine::cache()] [Medium - Unimplemented Panic] Lines 333-337 use unimplemented!() for cache - if any code path accidentally calls this, it causes an immediate panic and potential DoS. (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_a63b1df4-be89-4057-8a88-c4be75fb2314?mode=deep",
    "timestamp": "2026-02-06 20:41:43.094813",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignMachine::from_cache()] [Medium - Unimplemented Panic] Lines 340-348 use unimplemented!() for from_cache - could coordinator retry logic accidentally call this and crash the processor? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ca3f8e32-7e8e-49cb-a297-1f63bd65c42b?mode=deep",
    "timestamp": "2026-02-06 20:41:56.208600",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignatureMachine::complete()] [Critical - Share Ordering] Line 419 uses shares.remove(0) to get shares in order - if participants send shares in different orders, could this cause signatures to be assembled incorrectly? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_d88ab2f7-78c0-4b53-8406-564ed5f11519?mode=deep",
    "timestamp": "2026-02-06 20:42:09.579653",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignatureMachine::complete()] [High - Witness Size] Lines 422-424 create a witness with a single signature - if the signature is not exactly 64 bytes due to encoding, does this cause transaction invalidity? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_eb77d45f-2f0d-486d-a6b3-ef41fd596d05?mode=deep",
    "timestamp": "2026-02-06 20:42:23.569774",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignatureMachine::complete()] [Critical - Input Mutation] Line 417 mutates self.tx.input iteratively - if complete() is called twice, does it append duplicate witnesses or panic? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_86d59b28-1f0c-4711-9b37-1c534620d91f?mode=deep",
    "timestamp": "2026-02-06 20:42:38.781211",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignatureMachine::complete()] [High - Signature Verification] complete() assembles signatures but doesn't verify them - could malformed shares pass through and create an invalid Bitcoin transaction? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_81d23316-3580-4f6e-8884-b788f9c4cf83?mode=deep",
    "timestamp": "2026-02-06 20:42:55.611361",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignatureMachine::complete()] [Medium - Iterator Exhaustion] Line 417 zips input.iter_mut() with sigs.drain(..) - if these have different lengths due to bugs, does the zip silently truncate or panic? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_039fcb19-2226-4232-8889-dbb85b87718a?mode=deep",
    "timestamp": "2026-02-06 20:43:13.558857",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Cross-Function] [Critical - Key-Script Binding] If tweak_keys() at line 46 and p2tr_script_buf() at line 80 use different elliptic curve implementations, could they produce incompatible keys and scripts, making funds unspendable? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_3226d166-9715-479b-bd02-337d38c3d9a3?mode=deep",
    "timestamp": "2026-02-06 20:43:32.175351",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Cross-Function] [High - Offset Consistency] ReceivedOutput stores offsets at line 92, Scanner::register_offset validates them at line 180, but does SignableTransaction::multisig at line 273 verify offsets haven't been tampered with? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_af5bba3e-f83c-4850-8d06-103a6a2475d7?mode=deep",
    "timestamp": "2026-02-06 20:43:51.403189",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Cross-Function] [Critical - Fee Race Condition] If SignableTransaction::new() calculates fees at line 206 but the transaction is signed later, could network fee rates change causing the transaction to be stuck in mempool indefinitely? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ca478212-b6c1-4cbb-ae73-0e6fa1433c7c?mode=deep",
    "timestamp": "2026-02-06 20:44:11.610851",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Cross-Function] [High - State Machine Transition] The state machine transitions from TransactionMachine -> TransactionSignMachine -> TransactionSignatureMachine - if any transition fails, is partial state cleaned up or could it leak sensitive nonces? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_f013a5dc-75b7-4a8e-a333-74d3731e54c8?mode=deep",
    "timestamp": "2026-02-06 20:44:32.684894",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: tweak_keys()] [High - Side Channel] Does the conditional_select at lines 69-73 run in constant time, or could timing attacks reveal whether keys were negated? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_daca33d6-b5a1-49ed-a0bf-f33b8bfdafa8?mode=deep",
    "timestamp": "2026-02-06 20:44:54.081973",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: TransactionSignMachine::sign()] [Critical - Nonce Leakage] If taproot_key_spend_signature_hash at line 386 fails after nonces are committed but before signing completes, are the nonces safely disposed or could they be reused? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_fe3f551e-b1a5-4152-9e37-b363afc72252?mode=deep",
    "timestamp": "2026-02-06 20:45:16.851174",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - Timing Side Channel] The loop at lines 184-195 takes variable time based on how many increments are needed - could an attacker measure this timing to learn about the offset? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_98c7f089-8d89-455f-ac3c-3666327cf446?mode=deep",
    "timestamp": "2026-02-06 20:45:38.407640",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Medium - Concurrent Scanning] If multiple threads scan the same block simultaneously, could they produce duplicate ReceivedOutputs that cause double-counting of deposits? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_65808edc-38ad-4387-a595-fe430aa457dd?mode=deep",
    "timestamp": "2026-02-06 20:46:00.557610",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Reentrancy] If new() is called reentrantly with overlapping inputs, could the inputs.drain at line 253 cause one transaction to steal inputs from another? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_f6eeea96-2dbf-4f59-82e2-8e4a80e374e6?mode=deep",
    "timestamp": "2026-02-06 20:46:23.302642",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: ReceivedOutput::serialize()] [Low - Panic on Write] Line 146 uses unwrap() on write result - could this panic if the Vec allocation fails, causing validator crash? (Low)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_9342a050-b096-4572-930f-935f04ee2213?mode=deep",
    "timestamp": "2026-02-06 20:46:45.855014",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Panic on Checked Math] Line 199 uses expect() on try_from for data - if this path is reachable, it causes a panic instead of returning TransactionError::TooMuchData. (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_fd4206f1-0198-4ede-8df6-54c6fb04ba5d?mode=deep",
    "timestamp": "2026-02-06 20:47:09.774063",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: tweak_keys()] [Critical - Panic on Zero] Line 74 expects scaling by Â±1 never produces zero, but if subtle::ConditionallySelectable has a bug, could this panic during validator set initialization? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_a22df77e-27d3-444b-ba3a-1730975e973a?mode=deep",
    "timestamp": "2026-02-06 20:47:34.296991",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: ReceivedOutput::write()] [Medium - Endianness] Lines 138-140 serialize offset, output, outpoint - are these all little-endian/big-endian consistent with Bitcoin's encoding? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_e91e6bc4-7603-4532-b3e0-369228fc0846?mode=deep",
    "timestamp": "2026-02-06 20:47:59.278160",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::txid()] [High - Byte Order] Line 261 reverses txid bytes - is this consistently applied everywhere txids are compared, or could big-endian/little-endian confusion cause transaction mismatches? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ea360051-4f6c-4d0b-bdf0-12e6864a5894?mode=deep",
    "timestamp": "2026-02-06 20:48:23.628155",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Fee Griefing] If fee_per_vbyte at line 155 is set very low, line 211-213 checks against DEFAULT_MIN_RELAY_TX_FEE - could an attacker force validators to create unrelayable transactions? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_c51a8e4f-a93d-44a8-a528-1d76a8d5f89e?mode=deep",
    "timestamp": "2026-02-06 20:48:45.663458",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - DUST Attack] An attacker could deposit many outputs just above DUST (547 sats) then later withdraw, forcing validators to spend many inputs with high fees - is there UTXO consolidation logic? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_0eebea2a-0062-424b-aa06-2bd93ca23ccb?mode=deep",
    "timestamp": "2026-02-06 20:49:08.703916",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Change Address Griefing] If change address is None at line 153, all excess becomes fee - could an attacker manipulate inputs to force no change output and burn user funds? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_11462107-9bd9-4130-83fc-ba556b4cf790?mode=deep",
    "timestamp": "2026-02-06 20:49:32.351176",
    "report_generated": false
  }
]