[
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::new()] [High - Key Reuse] Does Scanner::new verify that the provided key hasn't been used before, or could reusing a key across validator sets cause transaction confusion? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_0c991444-7e31-4083-9a5b-c73a9d288eb2?mode=deep",
    "timestamp": "2026-02-06 19:29:44.480903",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Infinite Loop DoS] Lines 184-195 have a loop that increments offset until an even point is found - if an attacker provides an offset that leads to a cycle or if the RNG is broken, could this loop forever? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ae8482b8-fb31-4c27-8476-102a00957070?mode=deep",
    "timestamp": "2026-02-06 19:29:56.686847",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - Offset Collision] At line 187-189, if a script already exists, None is returned - but what if two legitimate payment channels independently derive the same offset? Are funds lost or is there a recovery mechanism? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_df29bf53-1170-46f6-8003-f294217384ba?mode=deep",
    "timestamp": "2026-02-06 19:30:09.584476",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Surjective Offset Mapping] The comment at lines 173-175 notes offsets are surjective not bijective - does this mean multiple logical addresses map to the same Bitcoin address, creating a mint/burn accounting vulnerability? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_33dce016-c170-4b39-a996-39c18ded780b?mode=deep",
    "timestamp": "2026-02-06 19:30:22.762041",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - Arbitrary Script Path] The warning at lines 177-179 about arbitrary offsets introducing script paths is critical - how does the caller ensure offsets are securely generated? What prevents a malicious processor from registering exploitable offsets? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_2cbf6b44-3feb-4d96-9ac2-38b1e3af60fb?mode=deep",
    "timestamp": "2026-02-06 19:30:36.484180",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Medium - Offset Increment] At line 193, offset += Scalar::ONE could overflow if offset is already Scalar::MAX - does this wrap to zero or panic? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_6310ca95-3b01-4cf0-822f-b3ac74cb9199?mode=deep",
    "timestamp": "2026-02-06 19:30:51.819655",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [High - HashMap Poisoning] If an attacker can register many offsets, can they force the HashMap to reha hash causing DoS, or can they register offsets that collide with future legitimate offsets? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_dd547824-1e33-497a-939d-360969c6ecfe?mode=deep",
    "timestamp": "2026-02-06 19:31:07.418103",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::register_offset()] [Critical - Registration Order Dependency] The comment at line 174-175 states 'order offsets are registered in may determine validity of future offsets' - could this create a race condition where validators register offsets in different orders and scan different addresses? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_ffd8385d-ace0-4227-b462-b597adf61e8e?mode=deep",
    "timestamp": "2026-02-06 19:31:24.742497",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [High - Missing Outputs] At line 203, if vout exceeds 2^32 the scanning stops - could an attacker put a critical payment in output 2^32 + 1 to make it undetectable? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_9ea81458-daf9-4655-b81d-06bcee307e4f?mode=deep",
    "timestamp": "2026-02-06 19:31:43.422838",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Medium - Duplicate Detection] If the same script appears multiple times in tx.output, does scan_transaction return duplicate ReceivedOutputs with the same outpoint but different offsets? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_02883721-dd22-4507-80fd-46ec9a28fb74?mode=deep",
    "timestamp": "2026-02-06 19:32:02.549978",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [High - TxID Malleability] Line 209 uses compute_txid() - is this the witness-committed txid (wtxid) or the legacy txid, and could transaction malleability cause the same output to be seen with different outpoints? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_f00b8581-aa05-4a7b-a98e-3f421f8b0c3f?mode=deep",
    "timestamp": "2026-02-06 19:32:21.499476",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Critical - Script Clone] At line 208, output.clone() is called - if the output contains a large witness script, could this be a DoS vector through memory exhaustion? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_f39e7fbd-7bee-4bed-b5b2-05336e77b59d?mode=deep",
    "timestamp": "2026-02-06 19:32:41.344798",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Low - Vec Growth] The result Vec at line 200 has no capacity hint - for a transaction with many matching outputs, could repeated allocations cause performance issues? (Low)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_1408c249-da0f-4114-88f2-2f35964e07c2?mode=deep",
    "timestamp": "2026-02-06 19:33:01.674634",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_transaction()] [Medium - Vout Cast] The try_from at line 203 converts usize to u32 - on 64-bit systems with malicious input, could this silently truncate legitimate vout indices? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_db0660ba-0aeb-4a59-95ad-dac4b58a056a?mode=deep",
    "timestamp": "2026-02-06 19:33:24.062994",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [High - Coinbase Maturity] Lines 218-220 mention scanning coinbase transactions bound by maturity - if these immature outputs are used in subsequent transactions before maturity, do they cause consensus failures? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_9b06dad7-b598-415c-b39d-56e0df0cf564?mode=deep",
    "timestamp": "2026-02-06 19:33:46.759118",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Medium - Block Scanning Order] At line 223, block.txdata is scanned in order - if a reorg occurs and transactions are reordered, could this cause outputs to be double-counted or missed? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_41fca2ce-1ded-4f19-8c11-97d0eebff60c?mode=deep",
    "timestamp": "2026-02-06 19:34:10.922409",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Critical - Vec Extend DoS] Line 224 uses extend() without bounds checking - if block contains thousands of matching outputs, could this exhaust memory? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_6ac2b93b-6264-4978-9a9a-69d56499644c?mode=deep",
    "timestamp": "2026-02-06 19:34:35.620007",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/mod.rs] [Function: Scanner::scan_block()] [Low - Unused Result] The result Vec from scan_transaction is immediately extended into res - could there be any race condition or state inconsistency during this operation? (Low)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_019c8d4b-5429-4fe0-9d97-b989e0ced422?mode=deep",
    "timestamp": "2026-02-06 19:34:59.941739",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Insufficient Funds] At lines 215-221, the NotEnoughFunds check compares input_sat < (payment_sat + needed_fee), but does this account for potential integer overflow if payment_sat and needed_fee are near u64::MAX? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_010c94de-7ae2-4655-8211-fd46cba1926a?mode=deep",
    "timestamp": "2026-02-06 19:35:23.696111",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Fee Underestimation] The fee calculation at line 206 uses vbytes, but lines 225-234 recalculate with change - if the change output causes the transaction to cross a weight boundary, could the fee be underestimated? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_aae9ee59-cdd6-4019-99ef-bde6fefd28de?mode=deep",
    "timestamp": "2026-02-06 19:35:46.040316",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Change Output Theft] At lines 228-234, if input_sat.checked_sub returns None due to underflow, no change output is created and excess funds become fee - could an attacker manipulate inputs to cause this and steal funds via miner fees? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_6e0fa01d-7eab-462a-a555-675c70041678?mode=deep",
    "timestamp": "2026-02-06 19:36:08.198728",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - DUST Threshold Bypass] Lines 165-169 check payments against DUST (546 sats), but line 229 checks change against DUST - could an attacker craft inputs that create change just below DUST to burn user funds? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_e113ca2a-7295-456a-9df7-e2803d3d7d8e?mode=deep",
    "timestamp": "2026-02-06 19:36:27.570334",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Medium - Data Size Limit] Line 171-173 checks data.len() > 80 for OP_RETURN, but does this account for the OP_RETURN opcode bytes themselves, or could a 80-byte payload plus opcode exceed limits? (Medium)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_a933d497-40a3-4f8c-86f7-bede222a2004?mode=deep",
    "timestamp": "2026-02-06 19:36:43.460708",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [Critical - Empty Outputs] Line 237-239 checks if tx_outs is empty after all operations - could edge cases in change calculation cause all outputs to be removed, passing excess funds to miners? (Critical)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_2eab3931-dd32-4625-9093-9c27341dea6c?mode=deep",
    "timestamp": "2026-02-06 19:36:57.814736",
    "report_generated": false
  },
  {
    "question": "[File: networks/bitcoin/src/wallet/send.rs] [Function: SignableTransaction::new()] [High - Transaction Size Overflow] Line 241-243 checks weight against MAX_STANDARD_TX_WEIGHT, but is this checked before or after witnesses are added, and could witness data push it over the limit? (High)",
    "url": "https://deepwiki.com/search/-serai-security-audit-prompt-s_230735e5-7acd-4cc5-b191-eeb869180ddb?mode=deep",
    "timestamp": "2026-02-06 19:37:14.097774",
    "report_generated": false
  }
]